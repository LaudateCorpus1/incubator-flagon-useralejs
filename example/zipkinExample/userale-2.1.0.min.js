/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * @preserved
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).userale={})}(this,function(t){"use strict";var e="2.1.0",a=null;function n(i,a){Object.keys(a).forEach(function(e){if("userFromParams"===e){var n=(t=a[e],o=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),(r=window.location.href.match(o))&&r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):null);n&&(i.userId=n)}var t,o,r;i[e]=a[e]})}var f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var o,r,i=(function(e,n){var r=f&&f.__spreadArrays||function(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var o=Array(e),r=0;for(n=0;n<t;n++)for(var i=arguments[n],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var a=function(e,n,t){this.name=e,this.version=n,this.os=t};n.BrowserInfo=a;var t=function(e){this.version=e,this.name="node",this.os=process.platform};n.NodeInfo=t;var s=function(){this.bot=!0,this.name="bot",this.version=null,this.os=null};n.BotInfo=s;var l=3,u=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],i=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]];function o(i){var e=""!==i&&u.reduce(function(e,n){var t=n[0],o=n[1];if(e)return e;var r=o.exec(i);return!!r&&[t,r]},!1);if(!e)return null;var n=e[0],t=e[1];if("searchbot"===n)return new s;var o=t[1]&&t[1].split(/[._]/).slice(0,3);return o?o.length<l&&(o=r(o,function(e){for(var n=[],t=0;t<e;t++)n.push("0");return n}(l-o.length))):o=[],new a(n,o.join("."),d(i))}function d(e){for(var n=0,t=i.length;n<t;n++){var o=i[n],r=o[0];if(o[1].test(e))return r}return null}function c(){return"undefined"!=typeof process&&process.version?new t(process.version.slice(1)):null}n.detect=function(e){return e?o(e):"undefined"!=typeof navigator?o(navigator.userAgent):c()},n.parseUserAgent=o,n.detectOS=d,n.getNodeVersion=c}(o={exports:{}},o.exports),o.exports);(r=i)&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")&&r.default;i.BrowserInfo,i.NodeInfo,i.BotInfo;var s,l,u,d,c,m,p,w,g=i.detect,h=(i.parseUserAgent,i.detectOS,i.getNodeVersion,g()),v=null,y=null;function S(e,n){if(!l.on)return!1;var t=null;n&&(t=n(e));var o,r,i=(o=e.timeStamp&&0<e.timeStamp?l.time(e.timeStamp):Date.now(),{milli:Math.floor(o),micro:Number((o%1).toFixed(3))}),a={target:O(e.target),path:N(e),pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:I(),clientTime:i.milli,microTime:i.micro,location:null!=(r=e).pageX?{x:r.pageX,y:r.pageY}:null!=r.clientX?{x:document.documentElement.scrollLeft+r.clientX,y:document.documentElement.scrollTop+r.clientY}:{x:null,y:null},scrnRes:b(),type:e.type,logType:"raw",userAction:!0,details:t,userId:l.userId,toolVersion:l.version,toolName:l.toolName,useraleVersion:l.useraleVersion,sessionID:l.sessionID};return!("function"==typeof v&&!v(a))&&("function"==typeof y&&(a=y(a,e)),s.push(a),!0)}function b(){return{width:window.innerWidth,height:window.innerHeight}}function O(e){return e.localName?e.localName+(e.id?"#"+e.id:"")+(e.className?"."+e.className:""):e.nodeName?e.nodeName+(e.id?"#"+e.id:"")+(e.className?"."+e.className:""):e&&e.document&&e.location&&e.alert&&e.setInterval?"Window":"Unknown"}function N(e){var n=[];if(e.path)n=e.path;else for(var t=e.target;t;)n.push(t),t=t.parentElement;return function(e){var n,t=0,o=[];for(;n=e[t];)o.push(O(n)),++t;return o}(n)}function I(){return{browser:h.name,version:h.version}}var W,k,T,x=null;function E(e,n){var t,o;null!==x&&clearInterval(x),t=e,o=n,x=setInterval(function(){o.on&&t.length>=o.logCountThreshold&&(B(t.slice(0),o,0),t.splice(0))},o.transmitInterval),function(e,n){if(!n.on)return;navigator.sendBeacon?window.addEventListener("unload",function(){navigator.sendBeacon(n.url,JSON.stringify(e))}):window.addEventListener("beforeunload",function(){0<e.length&&B(e,n,1)})}(e,n)}function B(e,n,t){var o=new XMLHttpRequest,r=JSON.stringify(e);o.open("POST",n.url),n.authHeader&&o.setRequestHeader("Authorization",n.authHeader),o.setRequestHeader("Content-type","application/json;charset=UTF-8"),o.onreadystatechange=function(){4===o.readyState&&200!==o.status&&0<t&&B(e,n,t--)},o.send(r)}var A,D=["click","focus","blur","input","change","mouseover","submit"],M=["load","blur","focus"];function _(e){return{clicks:e.detail,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}function V(r){var e;return W={click:_,dblclick:_,mousedown:_,mouseup:_,focus:null,blur:null,input:(e=r).logDetails?function(e){return{value:e.target.value}}:null,change:e.logDetails?function(e){return{value:e.target.value}}:null,dragstart:null,dragend:null,drag:null,drop:null,keydown:e.logDetails?function(e){return{key:e.keyCode,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}:null,mouseover:null},k={},T={wheel:function(e){return{x:e.deltaX,y:e.deltaY,z:e.deltaZ}},scroll:function(){return{x:window.scrollX,y:window.scrollY}},resize:function(){return{width:window.outerWidth,height:window.outerHeight}}},A={submit:null},Object.keys(W).forEach(function(n){document.addEventListener(n,function(e){S(e,W[n])},!0)}),D.forEach(function(e){document.addEventListener(e,function(e){!function(e){var n=O(e.target),t=N(e),o=e.type,r=Math.floor(e.timeStamp&&0<e.timeStamp?l.time(e.timeStamp):Date.now());if(null==u&&(u=n,d=o,c=t,m=r,p=0),u!==n||d!==o){if(w={target:u,path:c,pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:I(),count:p,duration:r-m,startTime:m,endTime:r,type:d,logType:"interval",targetChange:u!==n,typeChange:d!==o,userAction:!1,userId:l.userId,toolVersion:l.version,toolName:l.toolName,useraleVersion:l.useraleVersion,sessionID:l.sessionID},"function"==typeof v&&!v(w))return;"function"==typeof y&&(w=y(w,e)),s.push(w),u=n,d=o,c=t,m=r,p=0}u==n&&d==o&&(p+=1)}(e)},!0)}),Object.keys(T).forEach(function(n){k[n]=!0,window.addEventListener(n,function(e){k[n]&&(k[n]=!1,S(e,T[n]),setTimeout(function(){k[n]=!0},r.resolution))},!0)}),Object.keys(A).forEach(function(o){document.addEventListener(o,function(e){var n,t;S(e,W[o]),n=s,(t=r).on&&0<n.length&&B(n,t,1)},!0)}),M.forEach(function(e){window.addEventListener(e,function(e){S(e,function(){return{window:!0}})},!0)}),1}var C={},K=[];function P(n){t.started||setTimeout(function(){var e=document.readyState;"interactive"===e||"complete"===e?(V(n),E(K,n),t.started=n.on=!0):P(n)},100)}t.started=!1,C.on=!1,C.useraleVersion=e,n(C,function(){var e,n,t={};null===a&&(e="userAleSessionId",n="session_"+String(Date.now()),a=null!==window.sessionStorage.getItem(e)?JSON.parse(window.sessionStorage.getItem(e)):(window.sessionStorage.setItem(e,JSON.stringify(n)),JSON.stringify(n)));var o,r=document.currentScript||(o=document.getElementsByTagName("script"))[o.length-1],i=r?r.getAttribute.bind(r):function(){return null};return t.autostart="false"!==i("data-autostart"),t.url=i("data-url")||"http://localhost:8000",t.transmitInterval=+i("data-interval")||5e3,t.logCountThreshold=+i("data-threshold")||5,t.userId=i("data-user")||null,t.version=i("data-version")||null,t.logDetails="true"===i("data-log-details"),t.resolution=+i("data-resolution")||500,t.toolName=i("data-tool")||null,t.userFromParams=i("data-user-from-params")||null,t.time=function(e){if(e.timeStamp&&0<e.timeStamp){var n,t=Date.now()-e.timeStamp;if(t<0)n=function(){return e.timeStamp/1e3};else if(t>e.timeStamp){var o=performance.timing.navigationStart;n=function(e){return e+o}}else n=function(e){return e}}else n=function(){return Date.now()};return n}(document.createEvent("CustomEvent")),t.sessionID=i("data-session")||a,t.authHeader=i("data-auth")||null,t.custIndex=i("data-index")||null,t}()),s=K,l=C,p=0,w=m=c=d=u=y=v=null,C.autostart&&P(C);t.buildPath=N,t.details=function(e,n){return{click:_,dblclick:_,mousedown:_,mouseup:_,focus:null,blur:null,input:e.logDetails?function(e){return{value:e.target.value}}:null,change:e.logDetails?function(e){return{value:e.target.value}}:null,dragstart:null,dragend:null,drag:null,drop:null,keydown:e.logDetails?function(e){return{key:e.keyCode,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}:null,mouseover:null,wheel:function(e){return{x:e.deltaX,y:e.deltaY,z:e.deltaZ}},scroll:function(){return{x:window.scrollX,y:window.scrollY}},resize:function(){return{width:window.outerWidth,height:window.outerHeight}},submit:null}[n]},t.filter=function(e){v=e},t.getSelector=O,t.log=function(e){return null!==e&&"object"==typeof e&&(K.push(e),!0)},t.map=function(e){y=e},t.options=function(e){return void 0!==e&&n(C,e),C},t.packageCustomLog=function(e,n,t){if(!l.on)return!1;var o=null;n&&(o=n());var r={pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:I(),clientTime:Date.now(),scrnRes:b(),logType:"custom",userAction:t,details:o,userId:l.userId,toolVersion:l.version,toolName:l.toolName,useraleVersion:l.useraleVersion,sessionID:l.sessionID},i=Object.assign(r,e);return!("function"==typeof v&&!v(i))&&("function"==typeof y&&(i=y(i)),s.push(i),!0)},t.packageLog=S,t.start=function(){t.started||P(C),C.on=!0},t.stop=function(){C.on=!1},t.version="2.1.0",Object.defineProperty(t,"__esModule",{value:!0})});