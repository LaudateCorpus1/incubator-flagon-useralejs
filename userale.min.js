!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.userale=t.userale||{})}(this,function(t){"use strict";function e(){v=[]}function n(){return v.length}function r(t){g=t}function o(t){return t.localName?t.localName+(t.id?"#"+t.id:"")+(t.className?"."+t.className:""):t.nodeName?t.nodeName:t&&t.document&&t.location&&t.alert&&t.setInterval?"Window":"Unknown"}function l(t){return t?t.map(function(t){return o(t)}):null}function u(t){return null!=t.pageX?{x:t.pageX,y:t.pageY}:null!=t.clientX?{x:document.documentElement.scrollLeft+t.clientX,y:document.documentElement.scrollTop+t.clientY}:{x:null,y:null}}function i(t,e){var n=null;e&&(n=e(t));var r={target:o(t.target),path:l(t.path),clientTime:t.timeStamp&&t.timeStamp>0?g.time(t.timeStamp):Date.now(),location:u(t),type:t.type,userAction:!0,details:n,userId:g.userId,toolVersion:g.version};v.push(r)}function a(t){r(t);var e={click:function(t){return{clicks:t.detail,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey,meta:t.metaKey}},dblclick:function(t){return{clicks:t.detail,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey,meta:t.metaKey}},mousedown:function(t){return{clicks:t.detail,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey,meta:t.metaKey}},mouseup:function(t){return{clicks:t.detail,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey,meta:t.metaKey}},focus:null,blur:null,input:t.logDetails?function(t){return{value:t.target.value}}:null,change:t.logDetails?function(t){return{value:t.target.value}}:null,dragstart:null,dragend:null,drag:null,drop:null,keydown:t.logDetails?function(t){return{key:t.keyCode,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey,meta:t.metaKey}}:null,mouseover:null,submit:null};Object.keys(e).forEach(function(t){document.addEventListener(t,function(n){i(n,e[t])},!0)});var n={wheel:function(t){return{x:t.deltaX,y:t.deltaY,z:t.deltaZ}},scroll:function(){return{x:window.scrollX,y:window.scrollY}},resize:function(){return{width:window.outerWidth,height:window.outerHeight}}},o={};Object.keys(n).forEach(function(e){o[e]=!0,window.addEventListener(e,function(r){o[e]&&(o[e]=!1,i(r,n[e]),setTimeout(function(){o[e]=!0},t.resolution))},!0)});var l=["load","blur","focus"],u=function(t){i(t,function(){return{window:!0}})};return l.forEach(function(t){window.addEventListener(t,u,!0)}),!0}function c(t,n){var r=new XMLHttpRequest;if(n)var o=n;else{var o=JSON.stringify(v);e()}r.open("POST",t),r.setRequestHeader("Content-type","application/json;charset=UTF-8"),r.onreadystatechange=function(){4===r.readyState&&200!==r.status&&c(t,o)},r.send(o)}function s(t){v.length>=t.logCountThreshold&&c(t.url),setTimeout(function(){s(t)},t.transmitInterval)}function d(t){window.addEventListener("beforeunload",function(){v.length>0&&c(t.url)},!0)}function f(){var t=document.currentScript||function(){var t=document.getElementsByTagName("script");return t[t.length-1]}(),e=t?t.dataset||{}:{};if(w.autostart=e.autostart||!0,w.url=e.url||"http://localhost:8000/logs",w.transmitInterval=e.interval||5e3,w.logCountThreshold=e.threshold||5,w.userId=e.user||null,w.version=e.version||null,w.logDetails=e.logDetails||!1,w.resolution=e.resolution||500,e.userFromParams){var n=e.userFromParams,r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),o=window.location.href.match(r);console.log(o),o&&o[2]?w.userId=decodeURIComponent(o[2].replace(/\+/g," ")):w.userId=null}w.time=m()}function m(){var t=document.createEvent("CustomEvent");if(t.timeStamp&&t.timeStamp>0){var e,n=Date.now()-t.timeStamp;if(n<0)e=function(){return t.timeStamp/1e3};else if(n>t.timeStamp){var r=performance.timing.navigationStart;e=function(t){return t+r}}else e=function(t){return t}}else e=function(){return Date.now()};return e}function y(){t.started||setTimeout(function(){var e=document.readyState;return"interactive"===e||"complete"===e?(a(w),s(w),d(w),t.started=!0,!0):void y()},100)}function p(){return w}function h(){return n()}var v=[],g={},w={};t.started=!1,function(){f(),w.autostart&&y()}(),t.start=y,t.currentConfigs=p,t.logCount=h,Object.defineProperty(t,"__esModule",{value:!0})});